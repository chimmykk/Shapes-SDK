"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.createSendMessage = createSendMessage;
function coreSendMessage(client, model) {
    return async (message) => {
        let openaiContent;
        if (typeof message === "string") {
            openaiContent = message;
        }
        else if (message.type === "text") {
            openaiContent = [{ type: "text", text: message.text }];
        }
        else if (message.type === "audio") {
            openaiContent = [{ type: "audio", audio: message.audio }];
        }
        else {
            openaiContent = "";
        }
        const res = await client.chat.completions.create({
            model,
            messages: [{ role: "user", content: openaiContent }],
        });
        return res.choices[0].message.content;
    };
}
function createSendMessage(client, defaultModel = "shapesinc/shaperobot") {
    const sendMessage = async (message, model = defaultModel) => coreSendMessage(client, model)(message);
    sendMessage.model = new Proxy({}, {
        get(_, modelName) {
            return coreSendMessage(client, modelName);
        },
    });
    return sendMessage;
}
